!function(a){"use strict";function b(b,d){var e=_.template(a("#feedback-template").html()),f=e({action:b,message:d});a("body").append(f),c(1e4)}function c(b){setTimeout(function(){a(".feedback").remove()},b)}function d(b,c){a.ajax({url:baseUrl+baseUrlCtrl+"/update_status",type:"POST",data:b,success:c})}function e(b){var c=a(b.currentTarget),e=c.closest("tr"),f=e.attr("data-status"),g=e.attr("data-id");d({id:g,active:f},function(a){e.attr("data-status",a),c.removeClass("btn-danger btn-success"),"1"==a?c.addClass("btn-success").text("Sim"):c.addClass("btn-danger").text("Não")})}function d(b,c){a.ajax({url:baseUrl+baseUrlCtrl+"/update_status",type:"POST",data:b,success:c})}function e(b){var c=a(b.currentTarget),e=c.closest("tr"),f=e.attr("data-status"),g=e.attr("data-id");d({id:g,active:f},function(a){e.attr("data-status",a),c.removeClass("btn-danger btn-success"),"1"==a?c.addClass("btn-success").text("Sim"):c.addClass("btn-danger").text("Não")})}function f(){var b=[];return a(".table tbody tr").each(function(){var c=a(this);1==c.find("input[type=checkbox]").is(":checked")&&b.push(c.attr("data-id"))}),b}function g(b){var c=a(".table tbody");_.each(b,function(a){c.find('tr[data-id="'+a+'"]').remove()})}function h(b,c){a.ajax({url:baseUrl+baseUrlCtrl+"/delete",type:"POST",dataType:"json",data:b,success:c})}function i(a){var c=f();h({ids:c},function(a){"true"==a.result?(b("success",a.msg),g(c)):b("danger",a.msg)})}function j(b,c){a.ajax({url:b,type:"POST",success:c})}function k(){a(".total-items-page").text(a(".table tbody tr").length)}function l(b){var c=a(b.currentTarget),d=+c.attr("data-page"),f=+c.attr("data-total-pages"),g=baseUrl+baseUrlCtrl+"/index/";c.hasClass("disabled")||(c.addClass("disabled"),d++,location.href.search("/index/")>=0?(g=location.href.split("/"),g.indexOf("index")>=0&&(g[g.indexOf("index")+1]=d),g=g.join("/")):g+=d,""!=strSearch&&(g+="/"+strSearch.replace(/ /gi,"+")),j(g,function(b){var g=a(b),h=a(".table");h.find("tbody").append(g.find("tbody").html()),d>=f?c.remove():c.attr("data-page",d).removeClass("disabled"),h.find("tbody a").each(function(){var b=a(this),c=b.attr("href");c=c.replace("edit/"+(d-1)+"/","edit/"+d+"/"),b.attr("href",c)}),a(".btn-status").off("click").on("click",e),u(),k()}))}function m(b){var c=a(b.currentTarget).val();location.href=baseUrl+baseUrlCtrl+"/total_itens_per_page/"+c}function n(b){var c,d=a(b.currentTarget),e=d.attr("data-order-asc"),f=d.attr("data-order-desc");(e||f)&&(d.hasClass("sorting")||d.hasClass("sorting_asc")?c=f:d.hasClass("sorting_desc")&&(c=e),location.href=c)}function o(b,c){a.ajax({url:baseUrl+"/home/newPassword",type:"POST",data:b,dataType:"json",success:c})}function p(){if(a(this).hasClass("login-form--pass"))return o({email:a(this).find("input[type=email]").val()},function(a){"false"==a.success?b("danger",a.msg):b("success",a.msg)}),!1}function q(b){b.preventDefault(),a(this).toggleClass("active"),a(".login-form").toggleClass("login-form--pass")}function r(b){var c=a(b.currentTarget),d=c.closest(".clone-container"),e=d.find(".clone-item:first").clone(),f=d.find(".clone-item");c.hasClass("btn-clone-add")?(e.find("div.cke").remove(),d.append(e),d.find(".clone-item:last .custom-editor").each(function(){var b=a(this).attr("id");b+="_"+Math.round(999*Math.random()),a(this).attr("id",b),CKEDITOR.replace(b)}),d.find(".clone-item:last .btn-delete-clone-item").removeClass("hide"),d.find(".clone-item:last .btn-delete-clone-item").on("click",s),d.find(".clone-item:last input").each(function(){a(this).is(":text")?a(this).val(""):a(this).is(":checkbox")&&a(this).prop("checked",!1)})):f.length>1&&f.filter(":last").remove()}function s(b){a(this).closest(".clone-item").remove()}function t(){var b=[];return a(".table tbody tr").each(function(){var c=a(this);b.push(c.attr("data-id"))}),b}function u(){a('.table input[type="checkbox"]').shiftSelectable()}function v(){function b(){a.ajax({url:baseUrl+baseUrlCtrl+"/sort_items_grid/",type:"POST",data:{id:t},success:function(a){console.log(a)}})}function c(a,b){b.helper.css("top",a.pageY-e)}var d=a(".table");if(!d.length)return!1;var e=d.eq(0).offset().top-38,f=function(b,c){return c.children().each(function(){a(this).width(a(this).width())}),c};a(".table").each(function(){if(a(this).hasClass("no-drag"))return!0;a(this).find("tbody").sortable({helper:f,stop:b,sort:c}).disableSelection()})}function w(){a(".check-all").on("click",function(b){1==a(this).is(":checked")?a(this).closest("table").find("tbody").find("input[type=checkbox]").prop("checked",!0):a(this).closest("table").find("tbody").find("input[type=checkbox]").prop("checked",!1)})}function x(b,c){var d=[];c.item.closest(".gallery").find("li").each(function(){d.push(a(this).attr("data-id"))}),a.ajax({url:baseUrl+baseUrlCtrl+"/sort_gallery",type:"post",dataType:"json",data:{ids:d},success:function(a){console.log(a)}})}function y(b){b.preventDefault();var c=a(b.currentTarget),d=c.closest(".gallery-item"),e=d.attr("data-id");return confirm("Você tem certeza que deseja excluir esse arquivo?")&&(d.remove(),a.ajax({url:baseUrl+baseUrlCtrl+"/delete_item",type:"post",data:{id:e},dataType:"json",success:function(a){console.log(a)}})),!1}function z(a,b){b.helper.css("top",a.pageY-b.helper.closest(".gallery").offset().top)}function A(){a(".gallery-container").each(function(){var c=a(this),d=c.attr("data-url-upload"),e=c.attr("data-input-hidden-name"),f=!!c.find(".file-upload").attr("multiple");c.find(".file-upload").fileupload({url:d,dataType:"json",done:function(a,d){c.find(".progress-bar").css("width","0%");var g=d.result;if("true"==g.result){var h="false"==g.fileIsImg?'<div class="gallery-item-info"><i class="fa fa-book"></i> '+g.idFile+"</div>":'<img src="'+g.pathFile+'" alt="">',i='<li class="gallery-item" data-id="'+g.idFile+'"> \t\t\t\t\t\t\t\t\t'+h+' \t\t\t\t\t\t\t\t\t<a href="#" class="btn btn-danger btn-sm btn-gallery-remove-item">Excluir</a> \t\t\t\t\t\t\t\t\t<input type="hidden" name="'+e+'[]" value="'+g.idFile+'"> \t\t\t\t\t\t\t\t</li>';f?c.find(".gallery ul").prepend(i):c.find(".gallery ul").html(i)}else b("danger",g.msg)},progressall:function(a,b){var d=parseInt(b.loaded/b.total*100,10);c.find(".progress-bar").css("width",d+"%")}}),c.find(".gallery").length||c.append('<div class="gallery clearfix"><ul></ul></div>'),c.find(".gallery ul").sortable({stop:x,sort:z,cursor:"move"}).disableSelection(),c.find(".btn-gallery-remove-item").on("click",y)})}function B(){a(".select2").select2(),a("[data-mask]").inputmask(),a(".date-picker").datepicker(),a(".color-picker").colorpicker(),a(".tags-input").each(function(){var b=a(this);b.attr("data-autocomplete-url")?b.tagsInput({autocomplete_url:b.attr("data-autocomplete-url"),autocomplete:{selectFirst:!0,autoFill:!0},defaultText:"Adicione"}):b.tagsInput()}),a('input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue"}),CKEDITOR.config.toolbar=[["Styles","Format","Font","FontSize"],["Bold","Italic","Underline","StrikeThrough","-","Undo","Redo","-","Cut","Copy","Paste","Find","Replace","-","Outdent","Indent","-","Print"],["NumberedList","BulletedList","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"],["Image","Table","-","Link","Flash","Smiley","TextColor","BGColor","Source"]],a(".custom-editor").each(function(){CKEDITOR.replace(a(this).attr("id"))})}function C(){a(".btn-delete-img-modal").on("click",function(b){b.preventDefault();var c=a(this),d=c.attr("data-url");c.parent().remove(),a.ajax({url:d,type:"post",dataType:"json"})})}function D(){u(),v(),w(),B(),A(),C()}c(4e3),a(".btn-status").on("click",e),a(".btn-status-project").on("click",e),a(".btn-delete-list-item").on("click",i),a(".btn-load-items").on("click",l),k(),a('select[name="updateTotalItemsPage"]').on("change",m),a(".table th").on("click",n),function(){var b=a(".table"),c=b.attr("data-order-field"),d=b.attr("data-order-sort");b.find("th").each(function(){var b=a(this),e=b.attr("data-order-asc"),f=b.attr("data-order-desc"),g=b.attr("data-field");(e||f)&&(g==c?"asc"==d?b.addClass("sorting_asc"):b.addClass("sorting_desc"):b.addClass("sorting"))})}(),a(".search-form").on("submit",function(b){var c=a(this).find(".form-control").val(),d=baseUrl+baseUrlCtrl;return""!=c&&(c=c.replace(/ /gi,"+"),d+="/index/1/"+c),location.href=d,!1}),a(".login-form").on("submit",p),a(".login-form-pass__btn").on("click",q),a(".btn-clone-add").on("click",r),a(".btn-clone-remove").on("click",r),a(".btn-delete-clone-item").on("click",s),a("input[data-id-slug-generator]").each(function(){var b=a(this),c=a("#"+b.attr("data-id-slug-generator"));b.on("change keyup",function(a){var d=url_slug(b.val());c.val(d).trigger("change")}),c.on("change keyup",function(b){var c=url_slug(a(b.currentTarget).val());a(b.currentTarget).val(c)})});var E;a("input[data-valid-input-backend]").each(function(){var b=a(this),c=b.prev(),d=b.closest(".form-group"),e=b.attr("data-valid-input-backend");c.attr("data-html",c.html()),b.on("change keyup",function(f){E&&E.abort(),E=a.ajax({url:e,type:"POST",dataType:"json",data:{input:b.val()},success:function(a){d.removeClass("has-success has-error"),"false"==a.result?(d.addClass("has-error"),c.html('<i class="fa fa-times-circle-o"></i> '+c.attr("data-html"))):(d.addClass("has-success"),c.html('<i class="fa fa-check"></i> '+c.attr("data-html")))}})})}),D()}(jQuery);